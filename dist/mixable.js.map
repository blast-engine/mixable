{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/copy-members.functions.js","webpack:///./src/mixable-behaviour.functions.js","webpack:///./src/mixable.js"],"names":["staticPropsToIgnore","prototypePropsToIgnore","copyMembers","source","dest","copyStaticMembers","copyInstanceMembers","giveProps","ignore","prototype","Object","getOwnPropertyNames","filter","includes","n","forEach","deleteProps","from","remove","META_KEY","initMixableMeta","constructor","name","constructors","getMixableMeta","Mixable","applyLayer","Onion","Layer","meta","mixableMeta","newConstructors","candidateName","some","existingLayerName","concat","applyParents","Parents","Parent","applySelf","layer","unshift","className","_constructor","callConstructors","instance","args","getPrototypeOf","call","DEFAULT_CLASS_NAME","isMixableClass","isMixableInstance","object","createMixableClass","inherits","body","staticProps","classFactory","Function","MixableClass","e","Error","message","inheritsFrom","OtherClasses","OC","every","n1","n2","is","MixableClasses","MC","keys","k"],"mappings":"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","file":"mixable.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/mixable.js\");\n","\nconst staticPropsToIgnore = [\n  \n  // js stuff\n  'name', 'prototype', 'arguments',\n  'caller', 'callee', 'length',\n\n  // our stuff\n  '__mixable_meta'\n\n]\n\nconst prototypePropsToIgnore = [\n\n  // js stuff\n  'constructor',\n\n]\n\n// ---- \n\nexport const copyMembers = ({\n  source /* MixableClass */,\n  dest /* MixableClass */,\n}) => {\n  copyStaticMembers({ source, dest })\n  copyInstanceMembers({ source, dest })\n}\n\n// ----\n\nexport const copyStaticMembers = ({\n source /* MixableClass */,\n dest /* MixableClass */,\n}) =>\n giveProps({\n   dest,\n   source,\n   ignore: staticPropsToIgnore\n })\n\n// ----\n\nexport const copyInstanceMembers = ({\n source /* MixableClass */,\n dest /* MixableClass */,\n}) =>\n giveProps({\n   source: source.prototype,\n   dest: dest.prototype,\n   ignore: prototypePropsToIgnore\n })\n\n// ----\n\nexport const giveProps = ({\n  source /* Object */,\n  dest /* Object */,\n  ignore /* Array<string> */,\n}) =>\n  Object.getOwnPropertyNames(source)\n    .filter(n => !ignore.includes(n))\n    .forEach(n => dest[n] = source[n])\n\n// ----\n\nexport const deleteProps = ({\n  from /* Object */,\n  remove /* Object */,\n  ignore /* Array<string> */,\n}) =>\n  Object.getOwnPropertyNames(remove)\n    .filter(n => !ignore.includes(n))\n    .forEach(n => delete from[n])","import { copyMembers } from './copy-members.functions'\n\nconst META_KEY = '__mixable_meta'\n\n/**\n * initializes the mixable metadata IN PLACE\n * @param constructor \n * @param name \n */\nexport function initMixableMeta(constructor, name) {\n  constructor[META_KEY] = { name, constructors: [] }\n}\n  \n/**\n * retrieves mixable data\n * @param Mixable \n */  \nexport function getMixableMeta(Mixable) {\n  return Mixable[META_KEY]\n}\n\n/**\n * \n * @param Onion \n * @param Layer \n */\nfunction applyLayer(Onion, Layer) {\n  const meta = Onion.mixableMeta()\n\n  const newConstructors = Layer.constructors()\n    .filter(({ name: candidateName }) => !Onion.constructors()\n      .some(({ name: existingLayerName }) => candidateName === existingLayerName )\n    )\n\n  meta.constructors = newConstructors.concat(Onion.constructors())\n\n  copyMembers({ source: Layer, dest: Onion })\n}\n\n/**\n * \n * @param Mixable \n * @param constructors \n */ \nexport function applyParents(Mixable, Parents) {\n  Parents.forEach(Parent => applyLayer(Mixable, Parent))\n}\n\n/**\n * \n * @param MixableClass \n * @param body \n */\nexport function applySelf(Mixable, layer){\n  \n  const meta = Mixable.mixableMeta()\n\n  meta.constructors.unshift({ \n    name: Mixable.className(),\n    _constructor: layer.prototype._constructor || function(){}\n  })\n\n  delete layer.prototype._constructor\n\n  copyMembers({ source: layer, dest: Mixable })\n\n}\n  \n/**\n * \n * @param instance \n * @param args \n */\nexport function callConstructors(\n  instance = {},\n  args = []\n) {\n  // @todo: this is too much back and forth between proto and constructor\n  getMixableMeta(Object.getPrototypeOf(instance).constructor)\n    .constructors\n    .forEach(({ _constructor }) => _constructor.call(instance, ...args))\n}","import { \n  callConstructors, \n  getMixableMeta, \n  initMixableMeta, \n  applyParents, \n  applySelf,\n} from './mixable-behaviour.functions'\n\nconst DEFAULT_CLASS_NAME = 'AnonymousClass'\n\nexport const isMixableClass = constructor => !!(\n  typeof constructor === 'function' \n  && getMixableMeta(constructor)\n) \n\nexport const isMixableInstance = object => !!(\n  typeof object === 'object' \n  && getMixableMeta(object.constructor)\n) \n\nexport function createMixableClass({\n  name = DEFAULT_CLASS_NAME,\n  inherits = [],\n  body = class {},\n  staticProps = {}\n}) {\n  \n  const classFactory = new Function('mixableClassConstructor', `\n    return function ${name}(...args) {\n      return mixableClassConstructor.call(this, ...args)\n    }\n  `)\n\n  const MixableClass = classFactory(function(...args) {\n    try {\n      callConstructors(this, args)\n    } catch(e) {\n      throw new Error(`error constructing ${MixableClass.className()}: ${e.message}`)\n    }\n    return this\n  })\n\n  MixableClass.mixableMeta = function () {\n    return getMixableMeta(this)\n  }\n  \n  MixableClass.className = function () {\n    return this.mixableMeta().name\n  }\n  \n  MixableClass.constructors = function () {\n    return this.mixableMeta().constructors\n  }\n\n  // @todo: doesnt check that inheritance chain is in correct order\n  MixableClass.inheritsFrom = function (...OtherClasses) {\n\n    if (OtherClasses.some(OC => !OC || !isMixableClass(OC))) throw new Error(\n      'invalid argument provided to MixableClass.inheritsFrom(). '\n      + 'expected array of mixable classes'\n    )\n    \n    return OtherClasses\n      .every(OC => OC.constructors()\n        .every(({ name: n1 }) => this.constructors()\n          .some(({ name: n2 }) => n1 === n2)))\n  }\n\n  MixableClass.prototype.is = function (...MixableClasses) {\n    return MixableClasses.every(MC => this.constructor.inheritsFrom(MC))\n  }\n\n  initMixableMeta(MixableClass, name)\n  applyParents(MixableClass, inherits)\n  applySelf(MixableClass, body)\n\n  Object.keys(staticProps).forEach(k => MixableClass[k] = staticProps[k])\n\n  return MixableClass\n}"],"sourceRoot":""}